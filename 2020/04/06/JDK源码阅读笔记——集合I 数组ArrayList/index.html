<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        JDK源码阅读笔记——集合Ⅰ数组ArrayList - Kamadev的博客 | Kamadev&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> technology, knowledge, life </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>Kamadev Choi</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-前言"><span class="toc-text">0.前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-类图"><span class="toc-text">2.类图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-属性"><span class="toc-text">3.属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-构造方法"><span class="toc-text">4.构造方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-添加元素与扩容"><span class="toc-text">5.添加元素与扩容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-add-E-e-——添加单个元素"><span class="toc-text">5.1.#add(E e)——添加单个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-add-int-index-E-element-——插入单个元素到指定位置"><span class="toc-text">5.2.#add(int index, E element) ——插入单个元素到指定位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-grow-——数组扩容"><span class="toc-text">5.3.#grow()——数组扩容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-addAll-Collection-lt-extends-E-gt-c-——添加多个元素"><span class="toc-text">5.4.#addAll(Collection&lt;? extends E&gt; c)——添加多个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-addAll-int-index-Collection-lt-extends-E-gt-c-——从指定位置插入多个元素"><span class="toc-text">5.5.#addAll(int index, Collection&lt;? extends E&gt; c)——从指定位置插入多个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-ensureCapacity-int-minCapacity-——主动扩容"><span class="toc-text">5.6.#ensureCapacity(int minCapacity)——主动扩容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-移除元素与缩容"><span class="toc-text">6. 移除元素与缩容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-remove-int-index-——移除单个元素"><span class="toc-text">6.1.#remove(int index)——移除单个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-removeRange-int-fromIndex-int-toIndex-——移除指定区间元素"><span class="toc-text">6.2.#removeRange(int fromIndex, int toIndex)——移除指定区间元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-removeAll-Collection-lt-gt-c-——移除指定多个元素"><span class="toc-text">6.3.#removeAll(Collection&lt;?&gt; c)——移除指定多个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-retainAll-Collection-lt-gt-c-——求elementData与多个元素交集"><span class="toc-text">6.4.retainAll(Collection&lt;?&gt; c)——求elementData与多个元素交集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-trimToSize-——缩容"><span class="toc-text">6.5.#trimToSize()——缩容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-查找、获取与设定元素"><span class="toc-text">7.查找、获取与设定元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-indexOf-Object-o-——查找元素"><span class="toc-text">7.1.#indexOf(Object o)——查找元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-contains-Object-o-——判断是否包含该元素"><span class="toc-text">7.2.#contains(Object o)——判断是否包含该元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-lastIndexOf-Object-o-——查找最后一个指定元素的位置"><span class="toc-text">7.3.#lastIndexOf(Object o)——查找最后一个指定元素的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-get-int-index-——获取指定位置元素"><span class="toc-text">7.4.#get(int index)——获取指定位置元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-set-int-index-E-element-——在指定位置设定元素"><span class="toc-text">7.5. #set(int index, E element)——在指定位置设定元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-序列化与反序列化"><span class="toc-text">8.序列化与反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-writeObject-java-io-ObjectOutputStream-s-——序列化"><span class="toc-text">8.1.#writeObject(java.io.ObjectOutputStream s)——序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-readObject-java-io-ObjectInputStream-s-——反序列化"><span class="toc-text">8.2.#readObject(java.io.ObjectInputStream s)——反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#99-其他常用方法"><span class="toc-text">99.其他常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#99-1-toArray-——转换为数组"><span class="toc-text">99.1.#toArray()——转换为数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99-2-hashCode-——求哈希值"><span class="toc-text">99.2.#hashCode()——求哈希值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99-3-equals-Object-o-——判断相等"><span class="toc-text">99.3.#equals(Object o)——判断相等</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99-4-clear-——清空数组"><span class="toc-text">99.4.#clear()——清空数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99-5-clone-——克隆"><span class="toc-text">99.5.#clone()——克隆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99-6-subList-int-fromIndex-int-toIndex-——创建子数组"><span class="toc-text">99.6.#subList(int fromIndex, int toIndex)——创建子数组</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> technology, knowledge, life </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        JDK源码阅读笔记——集合Ⅰ数组ArrayList
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2020-04-06 22:49:39</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#jdk" title="jdk">jdk</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <blockquote>
<p>本JDK源码阅读笔记基于OpenJDK 13 : <a href="https://github.com/openjdk/jdk" target="_blank" rel="noopener">https://github.com/openjdk/jdk</a></p>
<p>一些可能表述或理解不当，请见谅</p>
</blockquote>
<h2 id="0-前言"><a href="#0-前言" class="headerlink" title="0.前言"></a>0.前言</h2><p>之前跟着<a href="http://www.iocoder.cn/" target="_blank" rel="noopener">芋道源码</a>的<strong>精尽 JDK 源码解析</strong>看了一遍，过了一个月后发现不做笔记不复习基本都忘光了，于是萌生了搭建一个博客来记录一下笔记，当是给自己挖一个坑吧。</p>
<h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h2><p><strong>ArrayList</strong> 是一个数组队列，相当于动态数组。它由数组实现，随机访问效率高，随机插入、随机删除效率低。</p>
<h2 id="2-类图"><a href="#2-类图" class="headerlink" title="2.类图"></a>2.类图</h2><p>ArrayList实现的接口、继承的抽象类，如下图所示：</p>
<p><img src="..%5Cimg%5CJDK01%5CArrayList.jpg" alt="ArrayList"></p>
<ul>
<li><strong>java.util.AbstractList</strong> 提供了List接口的骨架实现，大幅度的减少了实现<strong>迭代遍历</strong>相关操作的代码。如<u>#iterator()</u>、<u>#indexOf(Object o)</u>等方法</li>
<li><strong>java.util.List</strong> 提供数组的添加、删除、修改、迭代遍历等操作</li>
<li><strong>java.util.RandomAccess</strong> 表示ArrayList里的元素可以被高效的随机访问，以下标数字的方式获取元素</li>
<li><strong>java.io.Serialiable</strong> 表示ArrayList支持序列化和反序列化操作，具有固定的serialVersionUID属性值 </li>
<li><strong>java.lang.Cloneable</strong> 表示ArrayList支持调用Object的<u>#clone()</u>方法实现拷贝</li>
</ul>
<h2 id="3-属性"><a href="#3-属性" class="headerlink" title="3.属性"></a>3.属性</h2><p>ArrayList的属性只有两个：</p>
<p><img src="D:%5CBlog%5Csource%5Cimg%5CJDK01%5C02.png" alt=""></p>
<ul>
<li><p><strong>elementData</strong> 元素数组</p>
</li>
<li><p><strong>size</strong> 数组大小。<strong>size</strong>代表ArrayList已经使用elementData的元素的数量，调用<u>#size()</u>方法也是返回该属性大小。并且，当添加新的元素时，恰好其就是元素添加到数组的下标。然而，ArrayList真正的大小是<strong>elementData</strong>的大小。</p>
</li>
</ul>
<p>源码如下：</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * 元素数组</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * 当添加新的元素时，如果该数组容量不足，会创建新数组，并将原数组的元素拷贝到新数组。</span></span><br><span class="line"><span class="comment">  * 之后，将该变量的内存地址指向该新数组。</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * The array buffer into which the elements of the ArrayList are stored.</span></span><br><span class="line"><span class="comment">  * The capacity of the ArrayList is the length of this array buffer. Any</span></span><br><span class="line"><span class="comment">  * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span></span><br><span class="line"><span class="comment">  * will be expanded to DEFAULT_CAPACITY when the first element is added.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">transient</span> Object[] elementData; <span class="comment">// non-private to simplify nested class access</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * 已使用的数组的大小</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * The size of the ArrayList (the number of elements it contains).</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@serial</span></span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br></pre></td></tr></table></figure></code></pre><h2 id="4-构造方法"><a href="#4-构造方法" class="headerlink" title="4.构造方法"></a>4.构造方法</h2><p>ArrayList一共有3个构造方法</p>
<ol>
<li><strong><u>#ArrayList(int initialCapacity)</u></strong></li>
</ol>
<p>根据传入的容量来创建数组，合理使用避免扩容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化容量大于0时, 创建Object数组</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">    <span class="comment">// 初始化容量等于0时, 指向 EMPTY_ELEMENTDATA 对象</span></span><br><span class="line">    <span class="comment">// 添加元素时, 会进行扩容创建需要的数组</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    <span class="comment">// 初始化容量小于0时, 抛出异常</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong><u>#ArrayList()</u></strong></li>
</ol>
<p>无参默认构造函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 无参数构造</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Constructs an empty list with an initial capacity of ten.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong><u>#ArrayList(Collection&lt;? extends E&gt; c)</u></strong></li>
</ol>
<p>传入<strong>c</strong>集合，作为ArrayList的<strong>elementData</strong>进行初始化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 将c转换为Object数组</span></span><br><span class="line">    elementData = c.toArray();</span><br><span class="line">    <span class="comment">// 如果数组长度大于0</span></span><br><span class="line">    <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// defend against c.toArray (incorrectly) not returning Object[]</span></span><br><span class="line">        <span class="comment">// (see e.g. https://bugs.openjdk.java.net/browse/JDK-6260652)</span></span><br><span class="line">        <span class="comment">// 如果集合元素不是Object[]类型, 则会创建新的Object[], 并将elementData赋值到其中, 最后赋值给elementData</span></span><br><span class="line">        <span class="keyword">if</span> (elementData.getClass() != Object[]<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">            <span class="title">elementData</span> </span>= Arrays.copyOf(elementData, size, Object[]<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">// 如果数组长度等于0, 则使用EMPTY_ELEMENTDATA</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// replace with empty array.</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>附：ArrayList的三个<strong>常量</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 默认初始化容量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 共享的空数组对象</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 在&#123;<span class="doctag">@link</span> #ArrayList(int)&#125; 或 &#123;<span class="doctag">@link</span> #ArrayList(Collection)&#125; 构造方法中，</span></span><br><span class="line"><span class="comment"> * 如果传入的初始化大小或者集合大小为0时，将&#123;<span class="doctag">@link</span> #elementData&#125;指向它</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 共享的空数组对象, 用于&#123;<span class="doctag">@link</span> #ArrayList()&#125; 构造方法.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 通过使用该静态变量, 和&#123;<span class="doctag">@link</span> #EMPTY_ELEMENTDATA&#125;在第一次添加元素时区分开来</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>一般认为在初始化不指定容量时，ArrayList的默认大小为10。但实际上是初始化为<em>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</em>这个空数组，原因是考虑到部分场景下，ArrayList被初始化而实际并未使用。所以，ArrayList初始化时是个空数组，只有添加元素后，才会扩容为容量10的数组。</p>
</li>
<li><p><em>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</em>首次扩容10，而<em>EMPTY_ELEMENTDATA</em>按照1.5倍扩容</p>
</li>
</ul>
<h2 id="5-添加元素与扩容"><a href="#5-添加元素与扩容" class="headerlink" title="5.添加元素与扩容"></a>5.添加元素与扩容</h2><h3 id="5-1-add-E-e-——添加单个元素"><a href="#5-1-add-E-e-——添加单个元素" class="headerlink" title="5.1.#add(E e)——添加单个元素"></a>5.1.#add(E e)——添加单个元素</h3><p>  <strong>顺序</strong>添加元素到末尾，若容量不够会先进行扩容</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 增加数组修改次数, 父类AbstractList上, 定义了modCount属性, 用于记录数组修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 添加元素</span></span><br><span class="line">    add(e, elementData, size);</span><br><span class="line">    <span class="comment">// 返回添加成功</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e, Object[] elementData, <span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果容量不够, 进行扩容</span></span><br><span class="line">    <span class="keyword">if</span> (s == elementData.length)</span><br><span class="line">        elementData = grow();</span><br><span class="line">    <span class="comment">// 在数组末尾添加元素</span></span><br><span class="line">    elementData[s] = e;</span><br><span class="line">    <span class="comment">// 数量加一</span></span><br><span class="line">    size = s + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-add-int-index-E-element-——插入单个元素到指定位置"><a href="#5-2-add-int-index-E-element-——插入单个元素到指定位置" class="headerlink" title="5.2.#add(int index, E element) ——插入单个元素到指定位置"></a>5.2.#add(int index, E element) ——插入单个元素到指定位置</h3><p>  将index+1位置开始的元素往后挪1位，再把元素插入到指定位置</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验位置是否在数组范围内</span></span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">    <span class="comment">// 增加数组修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 如果数组大小不足, 进行扩容</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> s;</span><br><span class="line">    Object[] elementData;</span><br><span class="line">    <span class="keyword">if</span> ((s = size) == (elementData = <span class="keyword">this</span>.elementData).length)</span><br><span class="line">        elementData = grow();</span><br><span class="line">    <span class="comment">// 将index+1位置开始的元素往后挪</span></span><br><span class="line">    System.arraycopy(elementData, index,</span><br><span class="line">                     elementData, index + <span class="number">1</span>,</span><br><span class="line">                     s - index);</span><br><span class="line">    <span class="comment">// 设置元素到指定的位置</span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="comment">// 数组大小加一</span></span><br><span class="line">    size = s + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheckForAdd</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt; size || index &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-3-grow-——数组扩容"><a href="#5-3-grow-——数组扩容" class="headerlink" title="5.3.#grow()——数组扩容"></a>5.3.#grow()——数组扩容</h3><p>  当elementData容量不足时，会进行扩容。扩容首先创建一个新的更大的数组，一般是<strong>1.5</strong>倍大小，然后利用<strong><u>java.utils.Arrays#copyOf(T[], int)</u></strong>拷贝原有的数组到新数组，返回新数组</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object[] grow() &#123;</span><br><span class="line">    <span class="comment">// 最小需要扩容1</span></span><br><span class="line">    <span class="keyword">return</span> grow(size + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">private</span> Object[] grow(<span class="keyword">int</span> minCapacity) &#123;</span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">// 如果原容量大于0, 或者数组不是DEFAULTCAPACITY_EMPTY_ELEMENTDATA时, 计算新的数组大小, 并创建扩容</span></span><br><span class="line">    <span class="keyword">if</span> (oldCapacity &gt; <span class="number">0</span> || elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        <span class="comment">// 计算新的数组大小</span></span><br><span class="line">        <span class="comment">// 简单来说是Math.max(minGrowth, prefGrowth) + oldLength</span></span><br><span class="line">        <span class="comment">// 一般情况下, 是1.5倍扩容(&gt;&gt; 1 为右移操作，相当于除以 2). 但是存在两个特殊情况:</span></span><br><span class="line">        <span class="comment">// 1&gt; 初始化数组要求大小为0时, 此时使用minCapacity传入的1</span></span><br><span class="line">        <span class="comment">// 2&gt; 添加多个元素时, 传入的minCapacity不再仅仅加1,</span></span><br><span class="line">        <span class="comment">// 而是扩容到elementData恰好可以添加多个元素, 而该数量可能会超过当前size的1.5倍</span></span><br><span class="line">        <span class="keyword">int</span> newCapacity = ArraysSupport.newLength(oldCapacity,</span><br><span class="line">                minCapacity - oldCapacity, <span class="comment">/* minimum growth */</span></span><br><span class="line">                oldCapacity &gt;&gt; <span class="number">1</span>           <span class="comment">/* preferred growth */</span>);</span><br><span class="line">        <span class="keyword">return</span> elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">    <span class="comment">// 如果是DEFAULTCAPACITY_EMPTY_ELEMENTDATA数组, 直接创建新的数组</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> elementData = <span class="keyword">new</span> Object[Math.max(DEFAULT_CAPACITY, minCapacity)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-4-addAll-Collection-lt-extends-E-gt-c-——添加多个元素"><a href="#5-4-addAll-Collection-lt-extends-E-gt-c-——添加多个元素" class="headerlink" title="5.4.#addAll(Collection&lt;? extends E&gt; c)——添加多个元素"></a>5.4.#addAll(Collection&lt;? extends E&gt; c)——添加多个元素</h3><p>  在数组末尾批量添加多个元素，可以避免多次扩容</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 转换成a数组</span></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="comment">// 增加修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 如果a数组大小为0, 返回ArrayList数组无变化</span></span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="keyword">if</span> (numNew == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">// 如果elementData数组剩余容量不足, 则进行扩容, 扩至能容纳a数组</span></span><br><span class="line">    Object[] elementData;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> s;</span><br><span class="line">    <span class="keyword">if</span> (numNew &gt; (elementData = <span class="keyword">this</span>.elementData).length - (s = size))</span><br><span class="line">        elementData = grow(s + numNew);</span><br><span class="line">    <span class="comment">// 将a复制到elementData从s开始位置</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, s, numNew);</span><br><span class="line">    <span class="comment">// 数组大小加numNew</span></span><br><span class="line">    size = s + numNew;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-5-addAll-int-index-Collection-lt-extends-E-gt-c-——从指定位置插入多个元素"><a href="#5-5-addAll-int-index-Collection-lt-extends-E-gt-c-——从指定位置插入多个元素" class="headerlink" title="5.5.#addAll(int index, Collection&lt;? extends E&gt; c)——从指定位置插入多个元素"></a>5.5.#addAll(int index, Collection&lt;? extends E&gt; c)——从指定位置插入多个元素</h3><p>  从指定index位置插入多个元素，如果index开始的位置已经被占用，则把元素往后挪c的长度。*****号位置是差异点</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验范围是否在数组内</span></span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 转换成a数组</span></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="comment">// 增加修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 如果a数组大小为0, 返回ArrayList数组无变化</span></span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="keyword">if</span> (numNew == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">// 如果elementData数组剩余容量不足, 则进行扩容, 扩至能容纳a数组</span></span><br><span class="line">    Object[] elementData;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> s;</span><br><span class="line">    <span class="keyword">if</span> (numNew &gt; (elementData = <span class="keyword">this</span>.elementData).length - (s = size))</span><br><span class="line">        elementData = grow(s + numNew);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// **如果index开始的位置已经被占用, 将它们后移</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = s - index;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        System.arraycopy(elementData, index,</span><br><span class="line">                         elementData, index + numNew,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// 将a复制到elementData从s开始位置</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, index, numNew);</span><br><span class="line">    <span class="comment">// 数组大小加numNew</span></span><br><span class="line">    size = s + numNew;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-6-ensureCapacity-int-minCapacity-——主动扩容"><a href="#5-6-ensureCapacity-int-minCapacity-——主动扩容" class="headerlink" title="5.6.#ensureCapacity(int minCapacity)——主动扩容"></a>5.6.#ensureCapacity(int minCapacity)——主动扩容</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 保证elementData数组容量至少有minCapacity(主动扩容)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &gt; elementData.length <span class="comment">// 如果minCapacity大于数组的容量</span></span><br><span class="line">        &amp;&amp; !(elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span class="comment">// 如果elementData是DEFAULTCAPACITY_EMPTY_ELEMENTDATA的时候</span></span><br><span class="line">             &amp;&amp; minCapacity &lt;= DEFAULT_CAPACITY)) &#123; <span class="comment">// 需要最低容量大于DEFAULT_CAPACITY, 因为实际上容量是DEFAULT_CAPACITY</span></span><br><span class="line">        <span class="comment">// 数组修改次数加一</span></span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="comment">// 扩容</span></span><br><span class="line">        grow(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-移除元素与缩容"><a href="#6-移除元素与缩容" class="headerlink" title="6. 移除元素与缩容"></a>6. 移除元素与缩容</h2><h3 id="6-1-remove-int-index-——移除单个元素"><a href="#6-1-remove-int-index-——移除单个元素" class="headerlink" title="6.1.#remove(int index)——移除单个元素"></a>6.1.#remove(int index)——移除单个元素</h3><p>移除指定位置的单个元素，并返回该元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验index不超过size</span></span><br><span class="line">    Objects.checkIndex(index, size);</span><br><span class="line">    <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录该位置的原值</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>) E oldValue = (E) es[index];</span><br><span class="line">    <span class="comment">// 快速移除</span></span><br><span class="line">    fastRemove(es, index);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回该位置的原值</span></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-removeRange-int-fromIndex-int-toIndex-——移除指定区间元素"><a href="#6-2-removeRange-int-fromIndex-int-toIndex-——移除指定区间元素" class="headerlink" title="6.2.#removeRange(int fromIndex, int toIndex)——移除指定区间元素"></a>6.2.#removeRange(int fromIndex, int toIndex)——移除指定区间元素</h3><p>移除指定区间内多个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 范围不正确, 抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (fromIndex &gt; toIndex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(</span><br><span class="line">                outOfBoundsMsg(fromIndex, toIndex));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 修改次数加一</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 移除[fromIndex, toIndex)的多个元素</span></span><br><span class="line">    shiftTailOverGap(elementData, fromIndex, toIndex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shiftTailOverGap</span><span class="params">(Object[] es, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 将es从hi位置开始的元素, 移到lo位置开始</span></span><br><span class="line">    System.arraycopy(es, hi, es, lo, size - hi);</span><br><span class="line">    <span class="comment">// 将从[size - hi + lo, size)的元素置空, 因为已经被挪到前面了</span></span><br><span class="line">    <span class="comment">// i = (size -= hi - lo)更新了size</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> to = size, i = (size -= hi - lo); i &lt; to; i++)</span><br><span class="line">        es[i] = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-removeAll-Collection-lt-gt-c-——移除指定多个元素"><a href="#6-3-removeAll-Collection-lt-gt-c-——移除指定多个元素" class="headerlink" title="6.3.#removeAll(Collection&lt;?&gt; c)——移除指定多个元素"></a>6.3.#removeAll(Collection&lt;?&gt; c)——移除指定多个元素</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量移除多个指定元素</span></span><br><span class="line"><span class="comment"> * 通过两个变量w(写入位置)和r(读取位置), 按照r顺序遍历数组elementData</span></span><br><span class="line"><span class="comment"> * 如果不存在于指定的多个元素中, 则写入elementData的w位置, 然后w+1, 跳到下一个写入位置</span></span><br><span class="line"><span class="comment"> * 通过这样的方式, 实现将不存在elementData覆盖写到w位置</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> batchRemove(c, <span class="keyword">false</span>, <span class="number">0</span>, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * complement 参数，翻译过来是“补足”的意思。怎么理解呢？表示如果 elementData 元素在 c 集合中时，是否保留。</span></span><br><span class="line"><span class="comment"> * 如果 complement 为 false 时，表示在集合中，就不保留，这显然符合 #removeAll(Collection&lt;?&gt; c) 方法要移除的意图。</span></span><br><span class="line"><span class="comment"> * 如果 complement 为 true 时，表示在集合中，就暴露，这符合我们后面会看到的 #retainAll(Collection&lt;?&gt; c) 方法要求交集的意图。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">batchRemove</span><span class="params">(Collection&lt;?&gt; c, <span class="keyword">boolean</span> complement,</span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="keyword">final</span> <span class="keyword">int</span> from, <span class="keyword">final</span> <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验c非null</span></span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line">    <span class="keyword">int</span> r;</span><br><span class="line">    <span class="comment">// Optimize for initial run of survivors</span></span><br><span class="line">    <span class="comment">// 优化, 顺序遍历elementData数组, 找到第一个不符合complement, 然后结束遍历</span></span><br><span class="line">    <span class="keyword">for</span> (r = from;; r++) &#123;</span><br><span class="line">        <span class="comment">// 遍历到尾, 都没有不符合条件的, 直接返回false</span></span><br><span class="line">        <span class="keyword">if</span> (r == end)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">// 如果包含结果不符合complement时, 结束</span></span><br><span class="line">        <span class="keyword">if</span> (c.contains(es[r]) != complement)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置开始写入w为r, 注意不是r++</span></span><br><span class="line">    <span class="comment">// r++后, 用于读取下一个位置的元素. 因为通过上面的优化, 我们已经知道es[r]是不符合条件的</span></span><br><span class="line">    <span class="keyword">int</span> w = r++;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 继续遍历elementData数组, 如果符合条件, 则进行移除</span></span><br><span class="line">        <span class="keyword">for</span> (Object e; r &lt; end; r++)</span><br><span class="line">            <span class="keyword">if</span> (c.contains(e = es[r]) == complement) <span class="comment">// 判断符合条件</span></span><br><span class="line">                es[w++] = e; <span class="comment">// 移除的方式, 通过将当前值e写入到w位置, 然后w跳到下一个位置</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        <span class="comment">// Preserve behavioral compatibility with AbstractCollection,</span></span><br><span class="line">        <span class="comment">// even if c.contains() throws.</span></span><br><span class="line">        <span class="comment">// 如果contains方法发生异常, 则将es从r位置的数组写入到es从w开始的位置</span></span><br><span class="line">        System.arraycopy(es, r, es, w, end - r);</span><br><span class="line">        w += end - r;</span><br><span class="line">        <span class="comment">// 抛出异常</span></span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 增加数组修改次数</span></span><br><span class="line">        modCount += end - w;</span><br><span class="line">        <span class="comment">// 将数组[w, end)位置赋值为null</span></span><br><span class="line">        shiftTailOverGap(es, w, end);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-retainAll-Collection-lt-gt-c-——求elementData与多个元素交集"><a href="#6-4-retainAll-Collection-lt-gt-c-——求elementData与多个元素交集" class="headerlink" title="6.4.retainAll(Collection&lt;?&gt; c)——求elementData与多个元素交集"></a>6.4.retainAll(Collection&lt;?&gt; c)——求elementData与多个元素交集</h3><p>一样调用batchRemove，区别是传入true，即移除不在c的元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">retainAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> batchRemove(c, <span class="keyword">true</span>, <span class="number">0</span>, size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-5-trimToSize-——缩容"><a href="#6-5-trimToSize-——缩容" class="headerlink" title="6.5.#trimToSize()——缩容"></a>6.5.#trimToSize()——缩容</h3><p>建立与elementData同长度的数组，并进行复制</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">trimToSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 增加修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 如果有多余的空间, 则进行缩容</span></span><br><span class="line">    <span class="keyword">if</span> (size &lt; elementData.length) &#123;</span><br><span class="line">        elementData = (size == <span class="number">0</span>)</span><br><span class="line">          ? EMPTY_ELEMENTDATA <span class="comment">// 大小为0时, 直接使用EMPTY_ELEMENTDATA</span></span><br><span class="line">          : Arrays.copyOf(elementData, size); <span class="comment">// 大小大于0时, 则创建大小为size的新数组, 将原数组复制到其中</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-查找、获取与设定元素"><a href="#7-查找、获取与设定元素" class="headerlink" title="7.查找、获取与设定元素"></a>7.查找、获取与设定元素</h2><h3 id="7-1-indexOf-Object-o-——查找元素"><a href="#7-1-indexOf-Object-o-——查找元素" class="headerlink" title="7.1.#indexOf(Object o)——查找元素"></a>7.1.#indexOf(Object o)——查找元素</h3><p>从头开始遍历寻找目标元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> indexOfRange(o, <span class="number">0</span>, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">indexOfRange</span><span class="params">(Object o, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    Object[] es = elementData;</span><br><span class="line">    <span class="comment">// o为null的情况</span></span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt; end; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (es[i] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">// o非null的情况</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt; end; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(es[i])) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 找不到返回-1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-contains-Object-o-——判断是否包含该元素"><a href="#7-2-contains-Object-o-——判断是否包含该元素" class="headerlink" title="7.2.#contains(Object o)——判断是否包含该元素"></a>7.2.#contains(Object o)——判断是否包含该元素</h3><p>用上述的<u>#indexOf(Object o)</u>方法实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> indexOf(o) &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-lastIndexOf-Object-o-——查找最后一个指定元素的位置"><a href="#7-3-lastIndexOf-Object-o-——查找最后一个指定元素的位置" class="headerlink" title="7.3.#lastIndexOf(Object o)——查找最后一个指定元素的位置"></a>7.3.#lastIndexOf(Object o)——查找最后一个指定元素的位置</h3><p>和<u>#indexOf(Object o)</u>差不多，就是倒序遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lastIndexOfRange(o, <span class="number">0</span>, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lastIndexOfRange</span><span class="params">(Object o, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    Object[] es = elementData;</span><br><span class="line">    <span class="comment">// o为null的情况</span></span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = end - <span class="number">1</span>; i &gt;= start; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (es[i] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">// o非null的情况</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = end - <span class="number">1</span>; i &gt;= start; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(es[i])) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 找不到返回-1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-get-int-index-——获取指定位置元素"><a href="#7-4-get-int-index-——获取指定位置元素" class="headerlink" title="7.4.#get(int index)——获取指定位置元素"></a>7.4.#get(int index)——获取指定位置元素</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验index不超过size</span></span><br><span class="line">    Objects.checkIndex(index, size);</span><br><span class="line">    <span class="comment">// 获得index位置的元素--时间复杂度为O(1)</span></span><br><span class="line">    <span class="keyword">return</span> elementData(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-5-set-int-index-E-element-——在指定位置设定元素"><a href="#7-5-set-int-index-E-element-——在指定位置设定元素" class="headerlink" title="7.5. #set(int index, E element)——在指定位置设定元素"></a>7.5. #set(int index, E element)——在指定位置设定元素</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 校验index不超过size</span></span><br><span class="line">    Objects.checkIndex(index, size);</span><br><span class="line">    <span class="comment">// 获得index位置原来的值</span></span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line">    <span class="comment">// 修改index位置为新值</span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="comment">// 返回旧值</span></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-序列化与反序列化"><a href="#8-序列化与反序列化" class="headerlink" title="8.序列化与反序列化"></a>8.序列化与反序列化</h2><h3 id="8-1-writeObject-java-io-ObjectOutputStream-s-——序列化"><a href="#8-1-writeObject-java-io-ObjectOutputStream-s-——序列化" class="headerlink" title="8.1.#writeObject(java.io.ObjectOutputStream s)——序列化"></a>8.1.#writeObject(java.io.ObjectOutputStream s)——序列化</h3><p>elementData带有关键字transient，通常来说不会被序列化。</p>
<p>ArrayList的序列化是先写入非静态、非transient属性，然后再遍历写入elementData数据，节省空间和时间</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 实现ArrayList数组的序列化</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@java</span>.io.Serial</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> java.io.IOException </span>&#123;</span><br><span class="line">    <span class="comment">// Write out element count, and any hidden stuff</span></span><br><span class="line">    <span class="comment">// 获得当前数组的修改次数</span></span><br><span class="line">    <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line">    <span class="comment">// 写入非静态属性, 非transient属性</span></span><br><span class="line">    s.defaultWriteObject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Write out size as capacity for behavioral compatibility with clone()</span></span><br><span class="line">    <span class="comment">// 写入size, 主要为了与clone方法兼容</span></span><br><span class="line">    s.writeInt(size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Write out all elements in the proper order.</span></span><br><span class="line">    <span class="comment">// 逐个写入elementData数组的元素</span></span><br><span class="line">    <span class="comment">// elementData是transient定义的, 并不一定全满, 容量有一定的预留</span></span><br><span class="line">    <span class="comment">// 直接序列化, 会造成空间的浪费, 所以只序列化[0, size)的元素</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">        s.writeObject(elementData[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果数组修改次数发生了变化, 抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (modCount != expectedModCount) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-2-readObject-java-io-ObjectInputStream-s-——反序列化"><a href="#8-2-readObject-java-io-ObjectInputStream-s-——反序列化" class="headerlink" title="8.2.#readObject(java.io.ObjectInputStream s)——反序列化"></a>8.2.#readObject(java.io.ObjectInputStream s)——反序列化</h3><p>反序列化也是一样，先读取非静态、非transient属性，然后再逐个读取元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@java</span>.io.Serial</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read in size, and any hidden stuff</span></span><br><span class="line">    <span class="comment">// 读取非静态、非transient属性</span></span><br><span class="line">    s.defaultReadObject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read in capacity</span></span><br><span class="line">    <span class="comment">// 读取size, 不过忽略不用</span></span><br><span class="line">    s.readInt(); <span class="comment">// ignored</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// like clone(), allocate array based upon size not capacity</span></span><br><span class="line">        SharedSecrets.getJavaObjectInputStreamAccess().checkArray(s, Object[]<span class="class">.<span class="keyword">class</span>, <span class="title">size</span>)</span>;</span><br><span class="line">        <span class="comment">// 创建elements数组</span></span><br><span class="line">        Object[] elements = <span class="keyword">new</span> Object[size];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Read in all elements in the proper order.</span></span><br><span class="line">        <span class="comment">// 逐个读取</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            elements[i] = s.readObject();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 赋值给elementData</span></span><br><span class="line">        elementData = elements;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果size是0, 直接使用空数组</span></span><br><span class="line">        elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> java.io.InvalidObjectException(<span class="string">"Invalid size: "</span> + size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="99-其他常用方法"><a href="#99-其他常用方法" class="headerlink" title="99.其他常用方法"></a>99.其他常用方法</h2><h3 id="99-1-toArray-——转换为数组"><a href="#99-1-toArray-——转换为数组" class="headerlink" title="99.1.#toArray()——转换为数组"></a>99.1.#toArray()——转换为数组</h3><p>ArrayList提供两个方法用于把List转换为数组</p>
<ol>
<li>直接返回Object数组</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOf(elementData, size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>转换成指定类型数组</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;</span><br><span class="line">    <span class="comment">// 如果传入的数组小于size大小, 则直接复制一个新数组返回</span></span><br><span class="line">    <span class="keyword">if</span> (a.length &lt; size)</span><br><span class="line">        <span class="comment">// Make a new array of a's runtime type, but my contents:</span></span><br><span class="line">        <span class="keyword">return</span> (T[]) Arrays.copyOf(elementData, size, a.getClass());</span><br><span class="line">    <span class="comment">// 将elementData复制到a中</span></span><br><span class="line">    System.arraycopy(elementData, <span class="number">0</span>, a, <span class="number">0</span>, size);</span><br><span class="line">    <span class="comment">// 如果传入的数组长度大于size, 则将a[size]赋值为null</span></span><br><span class="line">    <span class="keyword">if</span> (a.length &gt; size)</span><br><span class="line">        a[size] = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// 返回a</span></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="99-2-hashCode-——求哈希值"><a href="#99-2-hashCode-——求哈希值" class="headerlink" title="99.2.#hashCode()——求哈希值"></a>99.2.#hashCode()——求哈希值</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取当前数组修改次数</span></span><br><span class="line">    <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line">    <span class="comment">// 计算哈希值</span></span><br><span class="line">    <span class="keyword">int</span> hash = hashCodeRange(<span class="number">0</span>, size);</span><br><span class="line">    <span class="comment">// 如果修改次数发生改变, 则抛出ConcurrentModificationException异常</span></span><br><span class="line">    checkForComodification(expectedModCount);</span><br><span class="line">    <span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hashCodeRange</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line">    <span class="comment">// 如果to超过大小, 则抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (to &gt; es.length) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 遍历每个元素, *31求哈希值</span></span><br><span class="line">    <span class="keyword">int</span> hashCode = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = from; i &lt; to; i++) &#123;</span><br><span class="line">        Object e = es[i];</span><br><span class="line">        hashCode = <span class="number">31</span> * hashCode + (e == <span class="keyword">null</span> ? <span class="number">0</span> : e.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="99-3-equals-Object-o-——判断相等"><a href="#99-3-equals-Object-o-——判断相等" class="headerlink" title="99.3.#equals(Object o)——判断相等"></a>99.3.#equals(Object o)——判断相等</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果是自己, 直接返回true</span></span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果不是List类型, 直接返回false</span></span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> List)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line">    <span class="comment">// ArrayList can be subclassed and given arbitrary behavior, but we can</span></span><br><span class="line">    <span class="comment">// still deal with the common case where o is ArrayList precisely</span></span><br><span class="line">    <span class="comment">// 根据不同类型, 调用不同比对的方法.</span></span><br><span class="line">    <span class="comment">// 主要考虑ArrayList可以直接使用其elementData属性, 性能更优</span></span><br><span class="line">    <span class="keyword">boolean</span> equal = (o.getClass() == ArrayList<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">        ? <span class="title">equalsArrayList</span>((<span class="title">ArrayList</span>&lt;?&gt;) <span class="title">o</span>)</span></span><br><span class="line">        : equalsRange((List&lt;?&gt;) o, 0, size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果修改次数发生改变, 则抛出ConcurrentModificationException异常</span></span><br><span class="line">    checkForComodification(expectedModCount);</span><br><span class="line">    <span class="keyword">return</span> equal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">equalsRange</span><span class="params">(List&lt;?&gt; other, <span class="keyword">int</span> from, <span class="keyword">int</span> to)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果to大于es的大小, 说明数组发生改变, 抛出异常</span></span><br><span class="line">    <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line">    <span class="keyword">if</span> (to &gt; es.length) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过迭代器遍历other, 然后逐个元素对比</span></span><br><span class="line">    <span class="keyword">var</span> oit = other.iterator();</span><br><span class="line">    <span class="keyword">for</span> (; from &lt; to; from++) &#123;</span><br><span class="line">        <span class="comment">// 如果oit没有下一个, 或者元素不相等, 返回false不匹配</span></span><br><span class="line">        <span class="keyword">if</span> (!oit.hasNext() || !Objects.equals(es[from], oit.next())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过oit是否遍历完, 实现大小是否相等效果</span></span><br><span class="line">    <span class="keyword">return</span> !oit.hasNext();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">equalsArrayList</span><span class="params">(ArrayList&lt;?&gt; other)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获得other数组的修改次数</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> otherModCount = other.modCount;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> s = size;</span><br><span class="line">    <span class="keyword">boolean</span> equal;</span><br><span class="line">    <span class="comment">// 判断数组大小是否相等</span></span><br><span class="line">    <span class="keyword">if</span> (equal = (s == other.size)) &#123;</span><br><span class="line">        <span class="keyword">final</span> Object[] otherEs = other.elementData;</span><br><span class="line">        <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line">        <span class="comment">// 如果s大于es或者otherEs的长度, 说明发生变化, 抛出异常</span></span><br><span class="line">        <span class="keyword">if</span> (s &gt; es.length || s &gt; otherEs.length) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 遍历, 逐个比较每个元素是否相等</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!Objects.equals(es[i], otherEs[i])) &#123;</span><br><span class="line">                equal = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>; <span class="comment">// 如果不相等, break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果other修改次数发生变化, 则抛出ConcurrentModificationException异常</span></span><br><span class="line">    other.checkForComodification(otherModCount);</span><br><span class="line">    <span class="keyword">return</span> equal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="99-4-clear-——清空数组"><a href="#99-4-clear-——清空数组" class="headerlink" title="99.4.#clear()——清空数组"></a>99.4.#clear()——清空数组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 增加数组修改次数</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 遍历数组, 倒序设置为null</span></span><br><span class="line">    <span class="keyword">final</span> Object[] es = elementData;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> to = size, i = size = <span class="number">0</span>; i &lt; to; i++)</span><br><span class="line">        es[i] = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="99-5-clone-——克隆"><a href="#99-5-clone-——克隆" class="headerlink" title="99.5.#clone()——克隆"></a>99.5.#clone()——克隆</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 调用父类, 进行克隆</span></span><br><span class="line">        ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) <span class="keyword">super</span>.clone();</span><br><span class="line">        <span class="comment">// 拷贝一个新的数组</span></span><br><span class="line">        v.elementData = Arrays.copyOf(elementData, size);</span><br><span class="line">        <span class="comment">// 设置新数组修改次数为0</span></span><br><span class="line">        v.modCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">        <span class="comment">// this shouldn't happen, since we are Cloneable</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> InternalError(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="99-6-subList-int-fromIndex-int-toIndex-——创建子数组"><a href="#99-6-subList-int-fromIndex-int-toIndex-——创建子数组" class="headerlink" title="99.6.#subList(int fromIndex, int toIndex)——创建子数组"></a>99.6.#subList(int fromIndex, int toIndex)——创建子数组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SubList 不是一个只读数组，而是和根数组 root 共享相同的 elementData 数组，</span></span><br><span class="line"><span class="comment"> * 只是说限制了 [fromIndex, toIndex) 的范围</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;E&gt; <span class="title">subList</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">    subListRangeCheck(fromIndex, toIndex, size);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SubList&lt;&gt;(<span class="keyword">this</span>, fromIndex, toIndex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SubList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">RandomAccess</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根ArrayList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ArrayList&lt;E&gt; root;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 父SubList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SubList&lt;E&gt; parent;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 起始位置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> offset;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//.......略</span></span><br></pre></td></tr></table></figure>

<p><strong>本文作者:</strong> Kamadev <br/> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文地址:</strong> [<a href="http://yoursite.com/2020/04/06/JDK源码阅读笔记——集合I">http://yoursite.com/2020/04/06/JDK源码阅读笔记——集合I</a> 数组ArrayList/](<a href="http://yoursite.com/2020/04/06/JDK源码阅读笔记——集合I">http://yoursite.com/2020/04/06/JDK源码阅读笔记——集合I</a> 数组ArrayList/) <br/><strong/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;版权声明:</strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" rel="noopener">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！<hr/></p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        
        <li>
            <a target="_blank" href="http://weibo.com/kamadev">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        

        
        <li>
            <a target="_blank"  href="https://github.com/CKamadev">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud" target="_blank" rel="noopener">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
        */
        if( '' || '')
        var disqus_config = function () {
            this.page.url = '';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://kamadev.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>



</html>
